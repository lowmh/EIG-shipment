(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3434],{48157:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/carrier/complete",function(){return i(48357)}])},33729:function(e,t,i){"use strict";var r=i(90948),n=i(87357),l=i(50591);let a=(0,r.ZP)(n.Z)(e=>{let{theme:t}=e,i=(0,l.Z)();return{[t.breakpoints.down("md")]:{"& .MuiStepper-horizontal:not(.MuiStepper-alternativeLabel)":{flexDirection:"column",alignItems:"flex-start"}},"& .MuiStep-root":{"& .step-label":{display:"flex",alignItems:"center",justifyContent:"center","& .MuiAvatar-root":{marginRight:t.spacing(4)}},"& .step-number":{fontWeight:"bold",fontSize:"2.125rem",marginRight:t.spacing(2.5),color:t.palette.text.primary},"& .step-title":{fontWeight:500,color:t.palette.text.primary,fontSize:t.typography.body1.fontSize},"& .step-subtitle":{color:t.palette.text.secondary,fontSize:t.typography.body2.fontSize},"& .MuiStepLabel-root.Mui-disabled":{"& .step-number":{color:t.palette.text.disabled}},"& .Mui-error":{"& .MuiStepLabel-labelContainer, & .step-number, & .step-title, & .step-subtitle":{color:t.palette.error.main}}},"& .MuiStepConnector-root":{"& .MuiStepConnector-line":{borderWidth:3,borderRadius:3},"&.Mui-active, &.Mui-completed":{"& .MuiStepConnector-line":{borderColor:t.palette.primary.main}},"&.Mui-disabled .MuiStepConnector-line":{borderColor:i.primaryLight.backgroundColor}},"& .MuiStepper-alternativeLabel":{"& .MuiStepConnector-root":{top:10},"& .MuiStepLabel-labelContainer":{display:"flex",alignItems:"center",flexDirection:"column","& > * + *":{marginTop:t.spacing(1)}}},"& .MuiStepper-vertical":{"& .MuiStep-root":{"& .step-label":{justifyContent:"flex-start"},"& .MuiStepContent-root":{borderWidth:3,marginLeft:t.spacing(2.25),borderColor:t.palette.primary.main},"& .button-wrapper":{marginTop:t.spacing(4)},"&.active + .MuiStepConnector-root .MuiStepConnector-line":{borderColor:t.palette.primary.main}},"& .MuiStepConnector-root":{marginLeft:t.spacing(2.25),"& .MuiStepConnector-line":{borderRadius:0}}}}});t.Z=a},48357:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return z}});var r=i(85893),n=i(86886),l=i(67720),a=i(15861),s=i(25358),o=i(67294),c=i(87357),d=i(66242),u=i(44472),m=i(11057),x=i(76624),h=i(83578),p=i(44267),g=i(78445),j=i(98456),b=i(58468),f=i(90948),Z=i(2734),v=i(63730),y=i(50591);let C=(0,f.ZP)(c.Z)(()=>({width:20,height:20,borderWidth:3,borderRadius:"50%",borderStyle:"solid"})),S=e=>{let{active:t,completed:i,error:n}=e,l=(0,Z.Z)(),a=(0,y.Z)();return n?(0,r.jsx)(v.Z,{icon:"tabler:alert-triangle",fontSize:20,color:l.palette.error.main,transform:"scale(1.2)"}):i?(0,r.jsx)(v.Z,{icon:"tabler:circle-check",fontSize:20,color:l.palette.primary.main,transform:"scale(1.2)"}):(0,r.jsx)(C,{sx:{borderColor:a.primaryLight.backgroundColor,...t&&{borderWidth:5,borderColor:"primary.main",backgroundColor:"light"===l.palette.mode?"common.white":"background.default"}}})};var P=i(56456),w=i(79268),_=i(50657),k=i(6514),M=i(31425),W=i(58877),N=i.n(W),D=i(6154);let I=e=>{let{setConfirmSignature:t}=e,i=(0,o.useRef)(null),[l,s]=(0,o.useState)(!1),[d,u]=(0,o.useState)(null),[x,h]=(0,o.useState)(""),[p,g]=(0,o.useState)(null),[b,f]=(0,o.useState)(null),[Z,v]=(0,o.useState)(!1),y=()=>{s(!0)},C=()=>s(!1),S=async()=>{if(i.current){if(i.current.isEmpty()){console.error("Signature canvas is empty!");return}let e=i.current.getCanvas(),t=document.createElement("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r&&(r.fillStyle="white",r.fillRect(0,0,t.width,t.height),r.drawImage(e,0,0));let n=t.toDataURL("image/png");console.log(n);let l=await fetch(n),a=await l.blob(),s=new Date,o=s.toISOString().split("T")[0],c=new File([a],"".concat(x,"_signature_").concat(o,".png"),{type:"image/png"});u(URL.createObjectURL(a)),g(c)}},w=async()=>{if(!p){console.error("No signature file to upload.");return}try{v(!0);let i="".concat("http://localhost:5000/").concat("api/image"),r=new FormData;r.append("files",p,p.name);let n=await D.Z.post(i,r);if(n.data){var e;f(d),t(null===(e=n.data)||void 0===e?void 0:e.uploadedImages[0])}}catch(e){console.error("Error uploading images:",e)}finally{v(!1),s(!1)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.ZP,{item:!0,xs:12,children:(0,r.jsx)(a.Z,{variant:"h6",children:"Signature"})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,children:(0,r.jsxs)(_.Z,{fullWidth:!0,maxWidth:"md",open:l,onClose:C,children:[(0,r.jsx)(k.Z,{sx:{alignItems:"center"},children:(0,r.jsx)(c.Z,{display:"flex",flexDirection:"column",alignItems:"center",children:Z?(0,r.jsx)(j.Z,{}):(0,r.jsx)(r.Fragment,{children:d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c.Z,{children:[(0,r.jsx)("img",{width:"150",src:d,alt:"signature",className:"signature"}),(0,r.jsx)(m.Z,{variant:"text",color:"primary",onClick:()=>u(""),children:"Clear"})]}),(0,r.jsx)(a.Z,{children:x})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c.Z,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",p:2,mb:6,sx:{width:{xs:"300px",md:"500px"},height:{xs:"300px",md:"250px"},border:"2px dashed #ccc",borderRadius:"10px",textAlign:"center",backgroundColor:"#f9f9f9","&:hover":{backgroundColor:"#f1f1f1"}},children:[(0,r.jsx)(N(),{penColor:"black",canvasProps:{width:250,height:200},ref:i}),(0,r.jsx)(m.Z,{onClick:()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.clear()},children:"Clear"})]}),(0,r.jsx)(P.Z,{fullWidth:!0,label:"Name",value:x,onChange:e=>h(e.target.value)})]})})})}),(0,r.jsxs)(M.Z,{sx:{justifyContent:"center"},children:[d?(0,r.jsx)(m.Z,{variant:"contained",sx:{mr:2},onClick:w,children:"Upload"}):(0,r.jsx)(m.Z,{variant:"contained",sx:{mr:2},onClick:S,children:"Save"}),(0,r.jsx)(m.Z,{variant:"tonal",color:"secondary",onClick:()=>C(),children:"Cancel"})]})]})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,children:b?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(c.Z,{children:(0,r.jsx)("img",{width:"150",src:b,alt:"signature",className:"signature"})})}):(0,r.jsx)(m.Z,{variant:"outlined",color:"inherit",onClick:y,children:"Signature"})})]})};var E=i(86501),F=i(33729);let L=[{title:"BigCommerce Order",subtitle:"Enter order number"},{title:"Order Details",subtitle:"Check order & customer details"},{title:"Shipment Details",subtitle:"Enter delivery details"}],R=()=>{let[e,t]=(0,o.useState)(0),[i,s]=(0,o.useState)(!1),[f,Z]=(0,o.useState)(0),[v,y]=(0,o.useState)(""),[C,_]=(0,o.useState)(null),[k,M]=(0,o.useState)(""),[W,N]=(0,o.useState)({page:0,pageSize:5}),[R,O]=(0,o.useState)([]),[z,A]=(0,o.useState)([]),T=(0,o.useMemo)(()=>[{flex:.2,minWidth:100,field:"product_name",headerName:"Product Name",renderCell:e=>{let{row:t}=e;return(0,r.jsx)(c.Z,{sx:{display:"flex",alignItems:"center"},children:(0,r.jsxs)(c.Z,{sx:{display:"flex",alignItems:"flex-start",flexDirection:"column"},children:[(0,r.jsx)(a.Z,{noWrap:!0,sx:{fontWeight:500,textDecoration:"none",color:"text.secondary","&:hover":{color:"primary.main"}},children:t.product_name}),(0,r.jsx)(a.Z,{noWrap:!0,variant:"body2",sx:{color:"text.disabled"},children:t.product_sku})]})})}},{flex:.08,minWidth:20,field:"quantity",headerName:"Quantity",renderCell:e=>{let{row:t}=e;return(0,r.jsx)(a.Z,{noWrap:!0,sx:{fontWeight:500,textDecoration:"none",color:"text.secondary","&:hover":{color:"primary.main"}},children:t.quantity})}}],[]),U=()=>{M(""),t(e=>e-1)},q=async()=>{M("");let i={};if(0===e&&(!C||C.b2b_order_id!==v)){var r,n,l,a;s(!0);try{let e="".concat("http://localhost:5000/").concat("api/bigCommerceOrder","/").concat(v,"?page=complete"),t=await D.Z.get(e);Z(null===(r=t.data)||void 0===r?void 0:r.id),_(null===(n=t.data)||void 0===n?void 0:n.orderData),s(!1)}catch(e){s(!1),M(null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(a=l.data)||void 0===a?void 0:a.message);return}}if(e===L.length-1){if(Array.isArray(R)&&0!==R.length||(i.confirmImages="At least one image is required"),Object.keys(i).length>0){Object.values(i).forEach(e=>E.ZP.error(e));return}try{let e=[...R,z],t="".concat("http://localhost:5000/").concat("api/imageGroup","/").concat(v),i=await D.Z.put(t,{shipmentStatus:"Completed",files:e});if(i.data){let e="".concat("http://localhost:5000/").concat("api/shipment","/").concat(f),t=await D.Z.put(e,{shipment_status_id:2});t.data&&E.ZP.success("Shipment Completed!")}}catch(e){console.log(e),E.ZP.error("Please try again!");return}}t(e=>e+1)},B=()=>{y(""),_(null),O([]),t(0)};return(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(F.Z,{children:(0,r.jsx)(x.Z,{activeStep:e,alternativeLabel:!0,children:L.map((e,t)=>(0,r.jsx)(u.Z,{children:(0,r.jsx)(h.Z,{StepIconComponent:S,children:(0,r.jsx)("div",{className:"step-label",children:(0,r.jsxs)("div",{children:[(0,r.jsx)(a.Z,{className:"step-title",children:e.title}),(0,r.jsx)(a.Z,{className:"step-subtitle",children:e.subtitle})]})})})},t))})}),(0,r.jsx)(d.Z,{sx:{mt:4},children:(0,r.jsx)(p.Z,{children:e===L.length?(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(a.Z,{children:"All steps are completed!"}),(0,r.jsx)(c.Z,{sx:{mt:4,display:"flex",justifyContent:"flex-end"},children:(0,r.jsx)(m.Z,{variant:"contained",onClick:B,children:"Reset"})})]}):(0,r.jsx)("form",{onSubmit:e=>e.preventDefault(),children:(0,r.jsxs)(n.ZP,{container:!0,spacing:5,children:[(0,r.jsxs)(n.ZP,{item:!0,xs:12,children:[(0,r.jsx)(a.Z,{variant:"body2",sx:{fontWeight:600,color:"text.primary"},children:L[e].title}),(0,r.jsx)(a.Z,{variant:"caption",component:"p",children:L[e].subtitle})]}),(e=>{switch(e){case 0:return(0,r.jsx)(o.Fragment,{children:i?(0,r.jsx)(n.ZP,{item:!0,xs:12,textAlign:"center",children:(0,r.jsx)(j.Z,{})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(P.Z,{fullWidth:!0,label:"Order number",value:v,placeholder:"abc123",onChange:e=>y(e.target.value),onKeyDown:e=>{"Enter"===e.key&&q()}})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,sm:6}),k&&(0,r.jsx)(n.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(a.Z,{variant:"caption",color:"error",children:k})})]})});case 1:var t;return(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(n.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(P.Z,{fullWidth:!0,value:null==C?void 0:C.customer_name,label:"Customer Name",disabled:!0})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(P.Z,{fullWidth:!0,value:null==C?void 0:C.customer_email,label:"Customer Email",disabled:!0})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(P.Z,{fullWidth:!0,value:null==C?void 0:C.company_name,label:"Company Name",disabled:!0})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,sm:6}),null==C?void 0:null===(t=C.customer_address)||void 0===t?void 0:t.map((e,t)=>(0,r.jsx)(n.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(P.Z,{fullWidth:!0,value:e,label:"Address ".concat(t+1),disabled:!0})},t)),(0,r.jsx)(n.ZP,{item:!0,xs:12,sm:3,children:(0,r.jsx)(P.Z,{fullWidth:!0,value:null==C?void 0:C.address_city,label:"City",disabled:!0})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,sm:3,children:(0,r.jsx)(P.Z,{fullWidth:!0,value:null==C?void 0:C.address_state,label:"State",disabled:!0})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,sm:3,children:(0,r.jsx)(P.Z,{fullWidth:!0,value:null==C?void 0:C.address_country,label:"Country",disabled:!0})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,sm:3,children:(0,r.jsx)(P.Z,{fullWidth:!0,value:null==C?void 0:C.address_zip,label:"Postcode",disabled:!0})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,children:(0,r.jsx)(l.Z,{sx:{width:"100%"}})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,children:(0,r.jsxs)(d.Z,{children:[(0,r.jsx)(g.Z,{title:"Products"}),(0,r.jsx)(b._,{autoHeight:!0,rowHeight:62,rows:(null==C?void 0:C.items)?C.items.map(e=>({...e,id:e.order_product_id})):[],columns:T,disableRowSelectionOnClick:!0,pageSizeOptions:[5,10,25,50],paginationModel:W,onPaginationModelChange:N})]})})]},e);case 2:return(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(w.Z,{confirmImages:R,setConfirmImages:O}),(0,r.jsx)(I,{setConfirmSignature:A})]},e);default:return"Unknown Step"}})(e),(0,r.jsxs)(n.ZP,{item:!0,xs:12,sx:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)(m.Z,{variant:"tonal",color:"secondary",disabled:0===e,onClick:U,children:"Back"}),(0,r.jsx)(m.Z,{variant:"contained",onClick:q,children:e===L.length-1?"Submit":"Next"})]})]})})})})]})},O=()=>(0,r.jsxs)(n.ZP,{container:!0,spacing:6,children:[(0,r.jsx)(s.Z,{title:(0,r.jsx)(a.Z,{variant:"h2",children:"Complete Shipment"})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,mt:3,mb:3,children:(0,r.jsx)(l.Z,{})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,children:(0,r.jsx)(R,{})})]});O.acl={action:"read",subject:"complete-page"};var z=O}},function(e){e.O(0,[7693,8468,7375,3873,8877,1782,9774,2888,179],function(){return e(e.s=48157)}),_N_E=e.O()}]);